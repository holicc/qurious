query TIR
select
    nation,
    o_year,
    sum(amount) as sum_profit
from
    (
        select
            n_name as nation,
            extract(year from o_orderdate) as o_year,
            l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
        from
            part,
            supplier,
            lineitem,
            partsupp,
            orders,
            nation
        where
                s_suppkey = l_suppkey
          and ps_suppkey = l_suppkey
          and ps_partkey = l_partkey
          and p_partkey = l_partkey
          and o_orderkey = l_orderkey
          and s_nationkey = n_nationkey
          and p_name like '%green%'
    ) as profit
group by
    nation,
    o_year
order by
    nation,
    o_year desc
limit 10;
----
ALGERIA   1998 97864.5682 
ALGERIA   1997 368231.6695
ALGERIA   1996 196525.8046
ALGERIA   1995 341438.6885
ALGERIA   1994 677444.0160
ALGERIA   1993 458756.9157
ALGERIA   1992 549243.9511
ARGENTINA 1998 80448.7680 
ARGENTINA 1997 186279.1618
ARGENTINA 1996 154041.8822
